// ConsoleApplication1.cpp: определяет точку входа для консольного приложения.
//
/*Создать класс Time для работы со временем в формате "часы:минуты:секунды".

Класс должен включать в себя не менее 4х функций инициализации:
числами, строкой(например "23:59:59"), секундами, временем.

Обязательными операциями являются:
—Вычисление разности между двумя моментами времени в секундах+
—Вычитание из времени заданного количества секунд+
—Сравнение моментов времени +
—Перевод в секунды+
—Перевод в минуты(с округлением до целой минуты)+*/

#include "stdafx.h"
#include <iostream>
#include <string>
#include <sstream>

using namespace std;

class Time {

	int hour, min, sec;

public:

	Time(int h, int m, int s) {
		hour = h;
		min = m;
		sec = s;
	}

	Time(int s) {
		hour = s / 3600;
		min = (s - hour * 3600) / 60;
		sec = s - hour * 3600 - min * 60;
	}

	Time(const const char *str) {
		string a;
		int n = 0, time[3];
		for (int i = 0; i < (strlen(str) + 1); i++) {
			if (str[i] != ':') {
				a += str[i];
			}
			else {
				time[n] = atoi(a.c_str());
				n++;
				a = "";
			}

		}
		hour = time[0];
		min = time[1];
		sec = time[2];
	}

	/*Вычисление разности между двумя моментами в секундах*/
	int operator -(Time time2) {
		return ToSec() - time2.ToSec();
	}

	/*Вычитание из времени заданного количества секунд*/
	void operator -(int s) {
		Time interm(ToSec() - s);
		this->hour = interm.hour;
		this->min = interm.min;
		this->sec = interm.sec;
	}

	/*Сравнение двух моментов времени (равны?)*/
	bool operator ==(Time time2) {
		return (this->hour == time2.hour) && (this->min == time2.min) && (this->sec == time2.sec);
	}

	/*Сравнение двух моментов времени (не равны?)*/
	bool operator !=(Time time2) {
		return !(this->hour == time2.hour) && (this->min == time2.min) && (this->sec == time2.sec);
	}

	/*Сравнение двух моментов времени (меньше?)*/
	bool operator <(Time time2) {
		if (this -> hour < time2.hour) return true;
		else if (this->hour > time2.hour) return false;

		if (this->min < time2.min) return true;
		else if (this->min > time2.min) return false;

		return (this->sec < time2.sec);
	}

	/*Сравнение двух моментов времени (больше??)*/
	bool operator >(Time time2) {
		if (this->hour > time2.hour) return true;
		else if (this->hour < time2.hour) return false;

		if (this->min > time2.min) return true;
		else if (this->min < time2.min) return false;

		return (this->sec > time2.sec);
	}


	/*Перевод числа в секунды*/
	int ToSec()
	{
		return (hour * 3600 + min * 60 + sec);
	}

	/*Перевод числа в минуты*/
	int ToMin()
	{
		return (hour * 60 + min) + round(sec/60.0);
	}

	string ToString(int h, int m, int s) {
		ostringstream oss;
		oss << h << ":" << m << ":" << s << endl;
		return oss.str();
	}

	void Display() {
		cout << ToString(hour,min,sec);
	}

};

/*Функция ввода времени*/
Time Init() {
	int answ;
	cout << "В каком виде вы хотите ввести время?" << endl;
	cout << "1. Числа" << endl;
	cout << "2. Секунды" << endl;
	cout << "3. Строка формата 'часы:минуты:секунды'" << endl;
	cin >> answ;
	switch (answ) {
	case 1: {
		int h, m, s;
		cout << "Введите три числа : часы, минуты, секунды - через пробел" << endl;
		cin >> h >> m >> s;
		Time Ob(h, m, s);
		return Ob;
		break;
	}
	case 2: {
		int s;
		cout << "Введите время в секундах" << endl;
		cin >> s;
		Time Ob(s);
		return Ob;
		break;
	}
	case 3: {
		char str[80];
		cout << "Введите время в формате - часы:минуты:секунды" << endl;
		cin >> str;
		Time Ob(str);
		return Ob;
		break;
	}
	default: {
		cout << "Ошибка. Введите корректный номер пункта меню." << endl;
		Init();
		break;
	}
	}
}

/*Функция работы со временем*/
void Task() {
	int answ;
	cout << "------------" << endl;
	cout << "Какое действие хотите выполнить?" << endl;
	cout << "1. Вычислить разность между двумя моментами в секундах" << endl;
	cout << "2. Вычитание из времени заданного количества секунд" << endl;
	cout << "3. Сравнение двух моментов времени" << endl;
	cout << "4. Перевод времени в секунды" << endl;
	cout << "5. Перевод времени в минуты (округляя до целых)" << endl;
	cin >> answ;
	switch (answ) {
	case 1: {
		cout << "------------" << endl;
		cout << "Введите два момента времени:" << endl;
		Time Ob1 = Init();
		Time Ob2 = Init();
		cout << "Разность между двумя моментами времени:" << endl;
		if (Ob1 > Ob2) {
			cout << Ob1 - Ob2 << endl;
		}
		else {
			if (Ob2 > Ob1) {
				cout << Ob2 - Ob1 << endl;
			}
			else {
				cout << "0" << endl;
			}
		}
		break;
	}
	case 2: {
		cout << "------------" << endl;
		cout << "Введите время :" << endl;
		Time Ob = Init();
		cout << "Введите количество секунд:" << endl;
		int n;
		cin >> n;
		Ob - n;
		cout << "Получившееся время после вычитания:" << endl;
		Ob.Display();
		break;
	}
	case 3: {
		cout << "------------" << endl;
		cout << "Введите два момента времени:" << endl;
		Time Ob1 = Init();
		Time Ob2 = Init();
		if (Ob1 == Ob2) {
			cout << "Моменты времени равны" << endl;
		}
		else {
			cout << "Моменты времени не равны" << endl;
			if (Ob1 < Ob2) {
				cout << "Первое время меньше второго" << endl;
			}
			else {
				cout << "Первое время больше второго" << endl;
			}
		}
		break;
	}
	case 4: {
		cout << "------------" << endl;
		cout << "Введите время:" << endl;
		Time Ob = Init();
		cout << "Время в секундах:" << endl;
		cout << Ob.ToSec() << endl;
		break;
	}
	case 5: {
		cout << "------------" << endl;
		cout << "Введите время:" << endl;
		Time Ob = Init();
		cout << "Время в минутах:" << endl;
		cout << Ob.ToMin() << endl;
		break;
	}
	default: {
		cout << "Ошибка. Введите корректный номер пункта меню." << endl;
		Task();
		break;
	}
	}
}

/*Функция продолжения действий*/
bool Answ() {
	int answ;
	cout << "------------" << endl;
	cout << "Хотите продолжить действия?" << endl;
	cout<<"1. Да"<<endl;
	cout << "2. Нет" << endl;
	cin >> answ;
	switch (answ)
	{
	case 1: {
		return true;
	}
	case 2: {
		return false;
	}
	default: {
		cout << "Ошибка. Введите корректный номер пункта меню." << endl;
		Answ();
		break;
	}
	}

}

void Repeat() {
	while (Answ()) {
		Task();
	}
}

int main()
{
	setlocale(LC_ALL, "Russian");
	Task();
	Repeat();
	system("pause");
	return 0;
}

